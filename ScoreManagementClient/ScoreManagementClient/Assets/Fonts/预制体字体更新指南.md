# 预制体字体更新指南

> 本指南说明如何直接修改预制体（Prefab）中的字体属性

## 📋 功能说明

预制体字体更新工具可以直接修改项目中的预制体文件，而不需要在运行时动态修改。这意味着：

✅ **修改预制体本身** - 直接修改.prefab文件的内容
✅ **自动应用到所有场景** - 所有使用该预制体的场景都会自动应用新字体
✅ **一次性更新** - 无需在每个场景中单独配置
✅ **批量处理** - 可以一次更新项目中的所有预制体

---

## 🚀 使用方法

### 方法一：使用批量更新工具（推荐）

1. **打开字体更新工具窗口**
   ```
   Unity菜单 → Tools → Project Font Updater → 打开字体更新工具
   ```

2. **选择字体资源**
   - **UGUI Text**：拖入 CN_Regular.ttf
   - **TextMeshPro**：拖入 CN_Regular_TMP.asset

3. **配置选项**
   - 勾选"更新 UGUI Text 组件"（如果需要）
   - 勾选"更新 TextMeshPro 组件"（如果需要）
   - 勾选"包含非激活的对象"（建议勾选）

4. **执行更新**
   - 点击"更新所有预制体"按钮
   - 等待处理完成
   - 查看统计信息

### 方法二：更新单个预制体

1. **在Project窗口中选中预制体**

2. **执行更新**
   ```
   右键 → Tools → Font Manager → 更新当前选中预制体的字体
   ```
   或
   ```
   Unity菜单 → Tools → Font Manager → 更新当前选中预制体的字体
   ```

3. **等待处理完成**

### 方法三：更新文件夹中的所有预制体

1. **在Project窗口中选中文件夹**

2. **执行更新**
   ```
   右键 → Tools → Font Manager → 更新当前选中文件夹下所有预制体字体
   ```
   或
   ```
   Unity菜单 → Tools → Font Manager → 更新当前选中文件夹下所有预制体字体
   ```

3. **等待处理完成**

---

## 📂 工具界面说明

### 批量更新工具窗口（ProjectFontUpdater）

```
┌─────────────────────────────────────┐
│   项目字体更新器                    │
│   ─────────────────────────        │
│   ⚠️ 此工具将直接修改项目中的所有   │
│      预制体文件，操作不可撤销！      │
│                                     │
│   1. 选择字体资源                   │
│   ☑ 更新 UGUI Text 组件           │
│     CN_Regular (UGUI): [字体拖放区] │
│     CN_Bold (UGUI): [字体拖放区]    │
│                                     │
│   ☑ 更新 TextMeshPro 组件          │
│     CN_Regular_TMP (TMP): [字体拖放]│
│     CN_Bold_TMP (TMP): [字体拖放]   │
│                                     │
│   2. 选项设置                      │
│   ☑ 包含非激活的对象               │
│                                     │
│   3. 执行更新                      │
│   [更新所有预制体]                  │
│                                     │
│   快捷操作                         │
│   [自动加载字体资源]               │
│   [打开字体文件夹]                 │
│   [刷新字体资源]                   │
└─────────────────────────────────────┘
```

---

## 🔍 更新流程

### 完整流程

```
1. 下载并导入字体
   ↓
2. 创建 TMP_FontAsset（如果使用TextMeshPro）
   ↓
3. 打开 Project Font Updater 窗口
   ↓
4. 加载/拖入字体资源
   ↓
5. 配置更新选项
   ↓
6. 执行批量更新
   ↓
7. 验证结果
```

---

## ⚙️ 详细步骤

### 第1步：准备字体资源

**如果还没有字体资源：**

1. 下载霞鹜文楷GB字体
   ```
   https://www.maoken.com/freefonts/16864.html
   ```

2. 导入到Unity
   ```
   复制 LXGWWenKaiGB-Regular.ttf 到：
   Assets/Fonts/
   ```

3. 创建TMP_FontAsset（如果使用TextMeshPro）
   ```
   右键字体文件 → Create → TextMeshPro → Font Asset
   配置字符集，点击 Generate Font Asset
   重命名为 CN_Regular_TMP
   ```

### 第2步：打开更新工具

```
Unity菜单 → Tools → Project Font Updater → 打开字体加载工具
```

或者：

```
Unity菜单 → Tools → Font Manager → 批量更新所有预制体字体...
```

### 第3步：加载字体资源

**方式A：自动加载（推荐）**
- 点击"自动加载字体资源"按钮
- 工具会自动查找以下位置的字体：
  - Assets/Fonts/CN_Regular.ttf
  - Assets/Fonts/LXGWWenKaiGB-Regular.ttf
  - Assets/Fonts/CN_Regular_TMP.asset

**方式B：手动拖放**
- 在Project窗口中找到字体文件
- 拖放到工具窗口的对应字段中

### 第4步：配置更新选项

**UGUI Text组件**
- 勾选"更新 UGUI Text 组件"
- 设置 CN_Regular（必需）
- 设置 CN_Bold（可选）

**TextMeshPro组件**
- 勾选"更新 TextMeshPro 组件"
- 设置 CN_Regular_TMP（必需）
- 设置 CN_Bold_TMP（可选）

**其他选项**
- 勾选"包含非激活的对象"（建议勾选，确保更新所有文本）

### 第5步：执行更新

1. 点击"更新所有预制体"按钮
2. 在确认对话框中点击"继续"
3. 等待进度条完成
4. 查看更新统计

### 第6步：验证结果

**方法A：打开场景检查**
1. 打开任意场景
2. 检查预制体中的文本组件
3. 确认字体已更新

**方法B：使用查找工具**
```
Unity菜单 → Tools → Font Manager → 查找当前场景中未使用CN_Regular字体的Text
```

**方法C：查看预制体文件**
1. 在Project窗口中选中预制体
2. 在Inspector中查看组件的Font属性

---

## 📊 更新统计说明

工具会显示以下统计信息：

| 项目 | 说明 |
|------|------|
| 总预制体数 | 项目中找到的预制体文件总数 |
| 已修改预制体 | 实际被修改的预制体数量 |
| 已修改UGUI组件 | 被更新的UGUI Text组件总数 |
| 已修改TMP组件 | 被更新的TMP_Text组件总数 |

---

## ⚠️ 重要提示

### 修改不可撤销

⚠️ **重要**：此工具会直接修改预制体文件，操作不可撤销！

建议：
1. **更新前备份项目**（推荐）
2. **使用版本控制**（如Git）
3. **先在小范围内测试**

### 自动应用到场景

更新预制体后，所有使用该预制体的场景会自动应用新字体：
- ✅ 无需手动修改场景
- ✅ 无需重新预制化
- ✅ 所有实例自动更新

### Unity需要刷新

更新完成后，Unity会自动刷新资源数据库，可能需要：
- 等待几秒钟让Unity重新导入
- 切换一下场景以查看效果
- 重新打开Unity（如果需要）

---

## 🔧 故障排除

### 问题：找不到字体资源

**错误信息：**
```
未找到字体资源！
请确保以下文件存在：
- Assets/Fonts/CN_Regular.ttf (UGUI)
- Assets/Fonts/CN_Regular_TMP.asset (TMP)
```

**解决方案：**
1. 检查字体文件是否在正确路径
2. 确认字体文件名是否正确
3. 点击"打开字体文件夹"按钮检查
4. 点击"刷新字体资源"按钮

### 问题：更新后场景中的字体没有变化

**可能原因：**
1. 场景中的预制体实例被覆盖
2. 预制体断开连接

**解决方案：**
1. 在Hierarchy中右键预制体实例 → Prefab → Revert
2. 重新预制化：GameObject → Apply Changes to Prefab
3. 删除实例，重新拖入预制体

### 问题：Unity卡顿或无响应

**可能原因：**
预制体数量过多

**解决方案：**
1. 分批更新（使用文件夹更新功能）
2. 关闭不必要的场景
3. 等待处理完成（可能需要几分钟）

### 问题：更新后字体显示异常

**可能原因：**
1. 字体文件损坏
2. TMP_FontAsset配置不正确

**解决方案：**
1. 重新生成TMP_FontAsset
2. 检查字体导入设置
3. 重新导入字体文件

---

## 📚 相关工具

### 项目中的字体管理工具

| 工具 | 功能说明 |
|------|---------|
| **Project Font Updater** | 批量更新所有预制体（本文档） |
| **Font Manager** | 运行时字体管理器 |
| **Font Manager Editor** | 编辑器菜单工具 |

### 快速访问菜单

```
Tools → Font Manager/
├── 配置当前场景所有UGUI Text使用CN_Regular字体
├── 配置当前场景所有TMP_Text使用CN_Regular字体
├── 配置所有文本组件（UGUI和TMP）
├── 重置当前场景所有UGUI Text字体为默认
├── 重置当前场景所有TMP_Text字体为默认
├── 查找当前场景中未使用CN_Regular字体的Text
├── 查找当前场景中未使用CN_Regular_TMP字体的TMP_Text
├── 显示TMP字体创建指南
├── 打开字体配置说明
├── 打开字体文件夹
├── 批量更新所有预制体字体... ⭐
├── 更新当前选中预制体的字体
└── 更新当前选中文件夹下所有预制体字体

Tools → Project Font Updater/
└── 打开字体更新工具 ⭐
```

---

## 💡 最佳实践

### 1. 工作流程建议

```
开发阶段：
├─ 使用Font Manager运行时管理
└─ 场景中手动配置字体

发布阶段：
├─ 使用Project Font Updater批量更新预制体
├─ 验证所有场景
└─ 提交版本控制
```

### 2. 版本控制建议

```
Git提交前：
1. 确认预制体更新完成
2. 检查修改的.prefab文件
3. 提交有意义的commit message
4. 推送到远程仓库
```

### 3. 分批更新建议

如果项目很大，建议分批更新：

```
第1批：UI预制体
第2批：游戏对象预制体
第3批：特效预制体
第4批：其他预制体
```

---

## 📞 技术支持

如有问题，请参考：
- **完整配置指南**：`Assets/Fonts/字体配置说明.md`
- **快速开始指南**：`Assets/Fonts/TextMeshPro快速开始.md`
- **Unity预制体文档**：https://docs.unity3d.com/Manual/Prefabs.html

---

## ✅ 检查清单

更新前：
- [ ] 已下载并导入字体文件
- [ ] 已创建TMP_FontAsset（如果使用TMP）
- [ ] 已备份项目或使用版本控制
- [ ] 已确认字体资源路径正确

更新中：
- [ ] 已打开Project Font Updater窗口
- [ ] 已加载字体资源
- [ ] 已配置更新选项
- [ ] 已执行更新并等待完成

更新后：
- [ ] 已检查更新统计信息
- [ ] 已打开场景验证字体
- [ ] 已检查所有预制体实例
- [ ] 已提交版本控制（如有）

---

## 🎉 完成示例

更新成功后，你应该看到：

```
[ProjectFontUpdater] 更新完成！
总预制体数：125
已修改预制体：87
已修改UGUI组件：234
已修改TMP组件：156
```

并且所有场景中的预制体都已经使用新的中文字体了！
