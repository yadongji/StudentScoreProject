# 中文字体配置说明

> 本配置指南同时支持 **UGUI Text** 和 **TextMeshPro** 两种文本组件

## 已选择的字体

**字体名称：** 霞鹜文楷 GB (Lxgw Wenkai GB)

**授权信息：** SIL Open Font License 1.1，可免费商用

**特点：**
- 支持简繁体中文，约13,515个汉字
- 3个字重：Light/Regular/Medium
- 开源字体，持续维护
- 版本：v1.521 (2025/10/10)

## 下载步骤

### 方法一：从猫啃网下载（推荐）

1. 访问下载页面：
   https://www.maoken.com/freefonts/16864.html

2. 下载字体压缩包：
   - 点击页面中的下载链接
   - 或直接访问：
   https://oss.maoken.com/猫啃字体/中国大陆/霞鹜文楷GB_1.521_猫啃网.zip

### 方法二：从GitHub下载

1. 访问GitHub发布页面：
   https://github.com/lxgw/LxgwWenkaiGB/releases/tag/v1.521

2. 在"Assets"区域下载：
   - 推荐：`LXGWWenKaiGB.zip`（包含所有字重）
   - 或单独下载：`LXGWWenKaiGB-Regular.ttf`（常规字重）

---

## 第一部分：配置UGUI Text组件

### 步骤1：解压字体文件
将下载的压缩包解压，找到.ttf或.otf格式的字体文件

### 步骤2：复制到Unity项目
将字体文件复制到以下目录：
```
ScoreManagementClient/Assets/Fonts/
```

### 步骤3：在Unity中导入字体

1. 打开Unity编辑器
2. 等待Unity导入字体文件（自动完成）
3. 在Project窗口中找到导入的字体
4. 选中字体，在Inspector中可以预览字体
5. 如果需要，可以调整字体设置（字符集、渲染模式等）

### 步骤4：重命名字体资产（可选但推荐）

为了方便脚本引用，建议重命名字体资产：

1. 在Project窗口中，选中导入的字体文件
2. 右键 -> Rename
3. 将常规字重重命名为 `CN_Regular`
4. 如果有粗体，重命名为 `CN_Bold`

---

## 第二部分：配置TextMeshPro组件

### 步骤1：创建TextMeshPro Font Asset

**方法一：使用Unity编辑器（推荐）**

1. 在Project窗口中，找到导入的字体文件（如：LXGWWenKaiGB-Regular.ttf）
2. 右键字体文件 -> **Create -> TextMeshPro -> Font Asset**
3. 在弹出的**Font Asset Creator**窗口中：

   **基本设置：**
   - **Source Font File**：选择你的字体文件
   - **Font Name**：CN_Regular
   - **Sampling Point Size**：保持默认（通常36）

   **字符集设置（重要）：**
   - **Character Set**：选择 **Custom** 或 **Custom Range**
   - 如果选择 **Custom**，点击文本框，选择 **Unicode Hex Range**
   - 添加中文字符范围：
     - 常用汉字：`4E00-9FFF`（约2万字）
     - 或按项目需求选择特定范围

   **图集设置：**
   - **Atlas Resolution**：512x512 或 1024x1024
   - **Atlas Padding**：9（默认）
   - **Atlas Render Mode**：SDF（推荐）

4. 点击 **Generate Font Asset**

**方法二：使用TMP Settings**

1. 打开菜单：**Window -> TextMeshPro -> Font Asset Creator**
2. 配置同上
3. 点击 **Generate Font Asset**

### 步骤2：保存和命名

1. 生成的Font Asset会保存在Fonts目录下
2. 将其重命名为：`CN_Regular_TMP.asset`
3. 如果需要粗体，重复上述步骤，命名为：`CN_Bold_TMP.asset`

### 步骤3：验证TMP Font Asset

1. 在Project窗口中选中生成的Font Asset
2. 在Inspector中预览字体
3. 确认字符集包含了所需的中文字符

---

## 第三部分：配置FontManager

### 步骤1：创建FontManager对象

1. 在Hierarchy窗口中右键 -> Create Empty
2. 将对象重命名为 "FontManager"
3. 选中对象，在Inspector中点击 "Add Component"
4. 搜索并添加 `FontManager` 组件

### 步骤2：设置字体资源

在FontManager组件的Inspector中：

**UGUI字体资源：**
1. **CN_Regular** 字段：拖入 `CN_Regular` 字体文件
2. **CN_Bold** 字段（可选）：拖入 `CN_Bold` 字体文件

**TextMeshPro字体资源：**
1. **CN_Regular_TMP** 字段：拖入 `CN_Regular_TMP.asset`
2. **CN_Bold_TMP** 字段（可选）：拖入 `CN_Bold_TMP.asset`

### 步骤3：配置场景中的文本组件

有两种方式：

**方式1：自动配置（推荐）**
- FontManager组件中勾选 "Auto Configure On Start"
- 场景启动时会自动配置所有Text和TMP_Text组件

**方式2：使用编辑器菜单**
- 打开Unity菜单：**Tools -> Font Manager**
- 选择对应的配置选项：
  - **配置当前场景所有UGUI Text使用CN_Regular字体**
  - **配置当前场景所有TMP_Text使用CN_Regular字体**
  - **配置所有文本组件（UGUI和TMP）** ⭐ 推荐

**方式3：使用FontManager组件右键菜单**
- 选中FontManager对象
- 在Inspector中右键FontManager组件
- 选择：
  - "配置所有Text使用CN_Regular字体"
  - "配置所有TMP_Text使用CN_Regular字体"
  - "配置所有文本组件使用中文字体" ⭐ 推荐

### 步骤4：应用到新创建的文本组件

当你创建新的文本组件时，可以：

1. **手动设置字体**：
   - UGUI Text：拖入CN_Regular字体文件
   - TMP_Text：拖入CN_Regular_TMP.asset

2. **使用代码自动设置**：
   ```csharp
   // UGUI Text
   FontManager.Instance.SetFont(textComponent);

   // TMP_Text
   FontManager.Instance.SetFont(tmpTextComponent);
   ```

---

## 第四部分：编辑器工具说明

### 可用菜单项（Tools -> Font Manager）

| 菜单项 | 功能说明 |
|--------|---------|
| 配置当前场景所有UGUI Text使用CN_Regular字体 | 批量配置UGUI Text组件 |
| 配置当前场景所有TMP_Text使用CN_Regular字体 | 批量配置TextMeshPro组件 |
| 配置所有文本组件（UGUI和TMP） | 一次性配置所有文本组件 ⭐ |
| 重置当前场景所有UGUI Text字体为默认 | 重置UGUI Text为Arial字体 |
| 重置当前场景所有TMP_Text字体为默认 | 重置TMP_Text为Liberation Sans SDF |
| 查找当前场景中未使用CN_Regular字体的Text | 检查UGUI Text配置 |
| 查找当前场景中未使用CN_Regular_TMP字体的TMP_Text | 检查TMP_Text配置 |
| 显示TMP字体创建指南 | 查看TMP字体创建教程 |
| 打开字体配置说明 | 打开本文档 |
| 打开字体文件夹 | 快速定位到Fonts目录 |

---

## 字体文件目录结构

最终的项目结构应该是：
```
ScoreManagementClient/
└── Assets/
    ├── Fonts/
    │   ├── CN_Regular.ttf          # UGUI字体文件
    │   ├── CN_Bold.ttf            # UGUI粗体文件（可选）
    │   ├── CN_Regular_TMP.asset   # TMP字体资产
    │   └── CN_Bold_TMP.asset      # TMP粗体资产（可选）
    ├── Scripts/
    │   ├── Utils/
    │   │   ├── FontManager.cs        # 运行时字体管理器
    │   │   └── FontInitializer.cs     # 编辑器启动检测
    │   └── Editor/
    │       └── FontManagerEditor.cs  # 编辑器扩展工具
    └── Fonts/
        └── 字体配置说明.md            # 本文档
```

---

## 注意事项

### UGUI Text
1. **字体文件大小：** 完整的霞鹜文楷GB字体文件较大（约10-15MB），首次导入Unity可能需要一些时间
2. **内存占用：** 字体会占用内存，如果项目中有大量文本，建议使用SpriteAtlas优化
3. **平台兼容性：** 该字体支持Windows、macOS、Linux、Android、iOS等主流平台

### TextMeshPro
1. **字符集选择：** 
   - **Custom**：包含完整中文字符集（推荐用于需要完整中文支持的项目）
   - **Custom Range**：手动指定字符范围（更节省空间）
   - **ASCII**：仅英文字符（不推荐中文项目使用）

2. **图集大小：**
   - **512x512**：适合项目字符需求较少的情况
   - **1024x1024**：推荐设置，平衡质量和性能
   - **2048x2048**：包含大量字符时使用

3. **采样点大小（Sampling Point Size）：**
   - 通常设置为36即可
   - 如果需要更高质量的显示，可以设置为72
   - 但会增加文件大小

4. **性能优化：**
   - 使用SDF渲染模式（默认）
   - 避免在一个Font Asset中包含过多不常用的字符
   - 考虑为不同场景创建不同的Font Asset

---

## 验证配置

配置完成后，可以：

1. **运行场景**，检查所有中文文本是否正常显示
2. **在Console中**查看FontManager的日志输出
3. **使用编辑器菜单**：Tools -> Font Manager -> 查找未使用指定字体的文本组件
4. **检查字体资产**：
   - UGUI：选中字体文件，在Inspector中预览
   - TMP：选中Font Asset，在Character Table中查看包含的字符

---

## 常见问题

### UGUI Text

**Q: 中文字符显示为方块？**
A: 检查Font设置中的"Character"选项是否选择了"Custom"并包含了所有需要的字符。

**Q: 字体显示模糊？**
A: 尝试在字体导入设置中将"Font Size"调大，或将"Render Mode"改为"Hinted Raster"。

**Q: 如何减少字体文件大小？**
A: 可以创建一个包含项目所需字符的字体文件，而不是使用完整字体。

### TextMeshPro

**Q: 中文字符显示为方块？**
A: 检查Font Asset的Character Set是否包含了中文字符（应该是Custom或Custom Range，并包含4E00-9FFF范围）。

**Q: 字体显示锯齿严重？**
A: 
- 确保使用SDF渲染模式
- 增加Sampling Point Size（如从36改为72）
- 提高Atlas Resolution（如改为2048x2048）

**Q: Font Asset文件太大？**
A:
- 减少字符集范围，只包含项目实际需要的字符
- 降低Atlas Resolution
- 将不常用的字符拆分到其他Font Asset中

**Q: 如何添加特殊字符或emoji？**
A: 在Font Asset创建时，在Character Sequence字段中直接输入需要包含的字符，或使用自定义字符集。

**Q: 多个TMP_Text使用不同字体？**
A: 可以创建多个Font Asset，并在FontManager中设置不同的字体资源，然后通过代码动态切换。

---

## 技术支持

如有问题，请参考：
- 霞鹜文楷官方GitHub：https://github.com/lxgw/LxgwWenkaiGB
- Unity UGUI字体文档：https://docs.unity3d.com/Manual/class-Font.html
- TextMeshPro官方文档：https://docs.unity3d.com/Packages/com.unity.textmeshpro@3.0/manual/index.html
- TMP Font Asset Creator：Window -> TextMeshPro -> Font Asset Creator

