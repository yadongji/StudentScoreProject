# 班级排名趋势分析工具

## 功能说明

此工具用于分析整个班级每个学生的排名变化情况，支持：

- 查看所有班级列表
- 选择特定班级和科目
- 按时间范围筛选（本学期、最近两次考试、全部历史）
- 显示进步和退步学生名单
- 自定义退步显示阈值

## 使用方法

### 快速启动

双击运行 `run_class_rank_visualizer.bat` 即可启动工具。

### 手动运行

在命令行中执行：

```bash
python class_rank_visualizer.py
```

## 功能特点

### 1. 班级选择
- 显示数据库中所有班级
- 输入班级编号进行选择

### 2. 科目选择
- 显示班级有成绩记录的所有科目
- 支持总分和单科查看
- 显示每个科目的记录数量

### 3. 时间范围选择
- **本学期**：最近6个月的考试记录
- **最近两次考试**：只分析最近两次考试的变化
- **全部历史数据**：分析所有历史记录

### 4. 排名类型选择
- **年级排名**（默认）：分析学生在年级中的排名变化
- **班级排名**：分析学生在班级中的排名变化

### 5. 退步阈值设置
- 可自定义退步显示阈值
- 默认显示退步5名及以上的学生
- 只有退步超过阈值的学生才会显示

### 6. 分析报告
- **进步学生**：显示所有有进步的学生（不管进步多少）
- **明显退步学生**：只显示退步超过阈值的学生
- **统计摘要**：显示班级人数、进步/退步人数、平均变化等

## 输出示例

### 控制台输出

```
================================================================================
          班级排名趋势分析工具
================================================================================

找到 3 个班级:
  1. 107班
  2. 108班
  3. 109班

请选择班级编号: 1

================================================================================
  107班 的考试科目
================================================================================
  1. 语文 (120条记录)
  2. 数学 (120条记录)
  3. 英语 (120条记录)
  4. 物理 (120条记录)
  5. 化学 (120条记录)
  6. 生物 (120条记录)
  7. 政治 (80条记录)
  8. 历史 (80条记录)
  9. 地理 (80条记录)
  10. 总分 (120条记录)

请选择科目（1-10）: 10

================================================================================
  选择时间范围
================================================================================
  1. 本学期（最近6个月）
  2. 最近两次考试
  3. 全部历史数据

请选择时间范围（1-3，默认3）: 2
  时间范围: 最近两次考试 (2025-10-15 至 2025-11-20)

================================================================================
  选择排名类型
================================================================================
  1. 年级排名（默认）
  2. 班级排名

请选择排名类型（1-2，默认1）: 1
  排名类型: 年级排名

退步显示阈值（退步多少名以上才显示，默认5名）: 5
退步阈值: 5名

正在获取107班的总分年级排名数据...

================================================================================
📊 107班 - 总分年级排名变化分析
================================================================================

📈 进步学生（共18人）:
序号   姓名        学号          变化     初始考试        初始排名     最近考试        最新排名    
--------------------------------------------------------------------------------
1      张三        2025001      +15      期中考试        35           月考            20
2      李四        2025002      +12      期中考试        42           月考            30
3      王五        2025003      +8       期中考试        28           月考            20
...

📉 明显退步学生（退步5名及以上，共3人）:
序号   姓名        学号          变化     初始考试        初始排名     最近考试        最新排名    
--------------------------------------------------------------------------------
1      赵六        2025010      -18      期中考试        15           月考            33
2      钱七        2025011      -10      期中考试        22           月考            32
3      孙八        2025012      -6       期中考试        25           月考            31

📌 统计摘要:
  班级总人数: 45人
  有记录人数: 40人
  进步人数: 18人
  退步人数: 19人
  保持不变: 3人
  平均进步: 7.2名
  平均退步: 8.5名

================================================================================
```

## 报表字段说明

- **序号**：学生编号
- **姓名**：学生姓名
- **学号**：学生学号
- **变化**：排名变化（+表示进步，-表示退步）
- **初始考试**：第一次考试的名称
- **初始排名**：第一次考试的班级排名
- **最近考试**：最近一次考试的名称
- **最新排名**：最近一次考试的班级排名

## 注意事项

1. 需要至少2次考试记录才能分析排名变化
2. 排名数字越小表示排名越高
3. 进步学生：显示所有有进步的学生（不管进步多少名）
4. 退步学生：只显示退步超过阈值的学生（默认5名）
5. 可以自定义退步显示阈值
6. 不生成图片，只输出文本报告
7. 年级排名：分析学生在整个年级中的排名变化
8. 班级排名：分析学生在班级中的排名变化

## 数据要求

- 学生信息中必须包含班级字段（ClassName）
- 成绩记录中必须包含班级排名（ClassRank）
- 需要有至少2次考试记录

